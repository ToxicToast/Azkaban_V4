name: Renovate

on:
    push:
        branches: [renovate/**/*, renovate/*]

env:
    NX_BRANCH: ${GITHUB_REF##*/}
    NODE_VERSION: 21
    MAX_PARALLEL: 3
    RUNNER_IMAGE: ubuntu-24.04

jobs:
    Feature:
        runs-on: ${{ env.RUNNER_IMAGE }}

        steps:
            - uses: actions/checkout@v4
              with:
                  fetch-depth: 0

          # - uses: nrwl/nx-set-shas@v4

            - name: ðŸ“¦ Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ env.NODE_VERSION }}

            - name: ðŸ“¦ Install dependencies
              run: npm install

            - name: ðŸ“¦ Install NX-Linux
              run: npm install @nx/nx-linux-x64-gnu@latest

            - name: ðŸš€ Check Format
              run: npm run nx format:check

            - name: ðŸš€ Lint Apps
              run: npm run nx affected:lint --parallel --maxParallel=${{ env.MAX_PARALLEL }}

            - name: ðŸš€ Test Apps
              run: npm run nx affected:test --passWithNoTests --parallel --maxParallel=${{ env.MAX_PARALLEL }}

            - name: ðŸš€ e2e Apps
              run: npm run nx affected:e2e --passWithNoTests --parallel --maxParallel=${{ env.MAX_PARALLEL }}

            - name: ðŸš€ Build Apps
              run: npm run nx affected:build --parallel --maxParallel=${{ env.MAX_PARALLEL }}
