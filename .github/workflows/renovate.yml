name: Renovate

on:
    push:
        branches: [renovate/**/*, renovate/*]

env:
    NX_BRANCH: ${GITHUB_REF##*/}

jobs:
    Feature:
        runs-on: self-hosted

        steps:
            - uses: actions/checkout@v4
              with:
                  fetch-depth: 0

            - uses: nrwl/nx-set-shas@v4

            - name: ðŸ“¦ Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: 21
                  cache: 'npm'

            - name: ðŸ“¦ Install NX-Linux
              run: npm install @nx/nx-linux-x64-gnu@latest

            - name: ðŸ“¦ Install dependencies
              run: npm ci

            - name: ðŸš€ Check Format
              run: npm run nx format:check

            - name: ðŸš€ Lint Apps
              run: npm run nx affected:lint --parallel --maxParallel=3

            - name: ðŸš€ Test Apps
              run: npm run nx affected:test --passWithNoTests --parallel --maxParallel=3

            - name: ðŸš€ e2e Apps
              run: npm run nx affected:e2e --passWithNoTests --parallel --maxParallel=3

            - name: ðŸš€ Build Apps
              run: npm run nx affected:build --parallel --maxParallel=3
